
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Análisis Exploratorio de Datos &#8212; Factores asociados al mecanismo de suicidio en Colombia (2015–2023)
</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = '↑';</script>
    <script>let toggleHintHide = '↓';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = 'div.cell div.cell_input';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = 'div.cell div.cell_input';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Eda';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Citations" href="referencias.html" />
    <link rel="prev" title="Datos y metodología" href="Datos_Met.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Logo.png" class="logo__image only-light" alt="Factores asociados al mecanismo de suicidio en Colombia (2015–2023)
 - Home"/>
    <script>document.write(`<img src="_static/Logo.png" class="logo__image only-dark" alt="Factores asociados al mecanismo de suicidio en Colombia (2015–2023)
 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Suicidio en Colombia
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduccion.html">Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="Datos_Met.html">Datos y metodología</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Análisis Exploratorio de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="referencias.html">Citations</a></li>

<li class="toctree-l1"><a class="reference internal" href="Ejercicios.html">Mapas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Eda.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Análisis Exploratorio de Datos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-del-analisis-una-mirada-inicial-a-los-datos">Fundamentos del Análisis: Una Mirada Inicial a los Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desarrollo-del-analisis-exploratorio-de-datos">Desarrollo del Análisis Exploratorio de Datos</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos">
<h1>Análisis Exploratorio de Datos<a class="headerlink" href="#analisis-exploratorio-de-datos" title="Link to this heading">#</a></h1>
<section id="fundamentos-del-analisis-una-mirada-inicial-a-los-datos">
<h2>Fundamentos del Análisis: Una Mirada Inicial a los Datos<a class="headerlink" href="#fundamentos-del-analisis-una-mirada-inicial-a-los-datos" title="Link to this heading">#</a></h2>
<p>El Análisis Exploratorio de Datos (EDA) constituye una etapa fundamental en toda investigación estadística, ya que permite comprender las características principales del conjunto de datos, identificar patrones, detectar posibles inconsistencias y orientar la preparación de la información antes del modelado.</p>
<p>En este estudio, el EDA tiene como propósito examinar los registros de suicidios en Colombia durante el periodo 2015–2023, con el fin de describir las variables sociodemográficas y contextuales asociadas y evaluar la calidad de los datos para la construcción de un modelo de regresión logística binaria.</p>
<p>En primer lugar, se realiza una revisión general del dataset, verificando el número de observaciones, la disponibilidad de variables y la presencia de valores faltantes o categorías indeterminadas. Posteriormente, se lleva a cabo un análisis univariado, en el que se describen la distribución de la variable dependiente (mecanismo de suicidio: generadores de asfixia vs otros) y de las principales variables independientes (sexo, edad, estado civil, escolaridad, escenario, zona, entre otras).</p>
<p>En una segunda fase, se desarrolla un análisis bivariado, explorando las asociaciones preliminares entre el mecanismo de suicidio y las variables sociodemográficas/contextuales. Esto incluye el uso de tablas de contingencia, gráficos comparativos y estimaciones de razones de momios (odds ratios) crudas en variables binarias.</p>
<p>Finalmente, a partir de los hallazgos del EDA, se definen las decisiones de recodificación, agrupación y preparación de variables que alimentarán el modelo de regresión logística, asegurando la validez y consistencia de los resultados.</p>
</section>
<section id="desarrollo-del-analisis-exploratorio-de-datos">
<h2>Desarrollo del Análisis Exploratorio de Datos<a class="headerlink" href="#desarrollo-del-analisis-exploratorio-de-datos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><ol class="arabic simple">
<li><p><em>Carga y dimensiones del DataFrame</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Carga, limpieza básica y Contar el número de filas y columnas en el DataFrame</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/jthowinsson/Suicidio_Colombia/main/Presuntos_Suicidios_con_Coor.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>  <span class="c1"># separador coma</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(23544, 42)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="2">
<li><p><em>Información general del DataFrame</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. Información general del dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Información general ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Información general ---
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 23544 entries, 0 to 23543
Data columns (total 42 columns):
 #   Column                                Non-Null Count  Dtype  
---  ------                                --------------  -----  
 0   ID                                    23544 non-null  int64  
 1   Año del hecho                         23544 non-null  int64  
 2   Grupo de edad de la victima           23544 non-null  object 
 3   Grupo Mayor Menor de Edad             23544 non-null  object 
 4   Edad judicial                         23544 non-null  object 
 5   Ciclo Vital                           23544 non-null  object 
 6   Sexo de la victima                    23544 non-null  object 
 7   Estado Civil                          23544 non-null  object 
 8   País de Nacimiento de la Víctima      23544 non-null  object 
 9   Escolaridad                           23544 non-null  object 
 10  Pertenencia Grupal                    23544 non-null  object 
 11  Mes del hecho                         23544 non-null  object 
 12  Dia del hecho                         23544 non-null  object 
 13  Rango de Hora del Hecho X 3 Horas     23544 non-null  object 
 14  Código Dane Municipio                 23544 non-null  int64  
 15  Municipio del hecho DANE              23544 non-null  object 
 16  Departamento del hecho DANE           23544 non-null  object 
 17  Código Dane Departamento              23544 non-null  int64  
 18  Escenario del Hecho                   23544 non-null  object 
 19  Zona del Hecho                        23544 non-null  object 
 20  Actividad Durante el Hecho            23544 non-null  object 
 21  Circunstancia del Hecho               23544 non-null  object 
 22  Manera de Muerte                      23544 non-null  object 
 23  Mecanismo Causal                      23544 non-null  object 
 24  Diagnostico Topográfico de la Lesión  23544 non-null  object 
 25  Presunto Agresor                      23544 non-null  object 
 26  Condición de la Víctima               23544 non-null  object 
 27  Medio de Desplazamiento o Transporte  23544 non-null  object 
 28  Servicio del Vehículo                 23544 non-null  object 
 29  Clase o Tipo de Accidente             23544 non-null  object 
 30  Objeto de Colisión                    23544 non-null  object 
 31  Servicio del Objeto de Colisión       23544 non-null  object 
 32  Razón del Suicidio                    23544 non-null  object 
 33  Localidad del Hecho                   23544 non-null  object 
 34  Ancestro Racial                       23544 non-null  object 
 35  Codigo_Dane_Municipio_norm            23544 non-null  int64  
 36  Muni_Cod                              23536 non-null  float64
 37  Muni_Nom                              23536 non-null  object 
 38  Depto_Cod                             23536 non-null  float64
 39  Depto_Nom                             23536 non-null  object 
 40  latitud                               23536 non-null  float64
 41  longitud                              23536 non-null  float64
dtypes: float64(4), int64(5), object(33)
memory usage: 7.5+ MB
None
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="3">
<li><p><em>Visualizar las primeras filas del DataFrame</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3. Vista preliminar de los datos (head)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Primeras filas ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Configurar pandas para mostrar todas las columnas y todo el ancho</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Primeras filas ---
   ID  Año del hecho Grupo de edad de la victima  \
0   1           2015                   (18 a 19)   
1   2           2015                   (25 a 29)   
2   3           2015                   (35 a 39)   
3   4           2015                   (55 a 59)   
4   5           2015                   (45 a 49)   

       Grupo Mayor Menor de Edad Edad judicial         Ciclo Vital  \
0  b) Mayores de Edad (&gt;18 años)     (18 a 19)  (18 a 28) Juventud   
1  b) Mayores de Edad (&gt;18 años)     (25 a 28)  (18 a 28) Juventud   
2  b) Mayores de Edad (&gt;18 años)     (35 a 39)   (29 a 59) Adultez   
3  b) Mayores de Edad (&gt;18 años)     (55 a 59)   (29 a 59) Adultez   
4  b) Mayores de Edad (&gt;18 años)     (45 a 49)   (29 a 59) Adultez   

  Sexo de la victima Estado Civil País de Nacimiento de la Víctima  \
0              Mujer   Soltero(a)                         Colombia   
1             Hombre   Soltero(a)                         Colombia   
2             Hombre  Unión libre                         Colombia   
3             Hombre   Soltero(a)                         Colombia   
4             Hombre   Soltero(a)                         Colombia   

                                Escolaridad  ...  \
0  Educación inicial y educación preescolar  ...   
1  Educación inicial y educación preescolar  ...   
2  Educación inicial y educación preescolar  ...   
3  Educación inicial y educación preescolar  ...   
4         Educación media o secundaria alta  ...   

                 Razón del Suicidio Localidad del Hecho Ancestro Racial  \
0                   Sin información           No aplica        Indigena   
1  Conflicto con pareja o ex pareja           No aplica         Mestizo   
2  Conflicto con pareja o ex pareja           No aplica         Mestizo   
3                   Sin información           No aplica         Mestizo   
4                   Sin información           No aplica         Mestizo   

  Codigo_Dane_Municipio_norm  Muni_Cod     Muni_Nom Depto_Cod  Depto_Nom  \
0                      66572   66572.0  PUEBLO RICO      66.0  RISARALDA   
1                      81001   81001.0       ARAUCA      81.0     ARAUCA   
2                      81220   81220.0  CRAVO NORTE      81.0     ARAUCA   
3                      63470   63470.0   MONTENEGRO      63.0    QUINDÍO   
4                      63130   63130.0      CALARCÁ      63.0    QUINDÍO   

    latitud   longitud  
0  5.222043 -76.030801  
1  7.072726 -70.747408  
2  6.303913 -70.204286  
3  4.565057 -75.749827  
4  4.520982 -75.646085  

[5 rows x 42 columns]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="4">
<li><p><em>Resumen de tipos de variables y valores faltantes</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4. Resumen de tipos de variables</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># === 1) Cargar datos desde GitHub ===</span>
<span class="c1">#url = &quot;https://raw.githubusercontent.com/jthowinsson/Suicidio_Colombia/main/Presuntos_Suicidios_con_Coor.csv&quot;</span>
<span class="c1">#df = pd.read_csv(url, encoding=&quot;utf-8&quot;)  # separador coma</span>

<span class="c1"># === 2) Tabla 1: Dimensiones ===</span>
<span class="n">dimensiones</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Registros&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
    <span class="s2">&quot;Variables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">})</span>

<span class="c1"># === 3) Conteo por tipo de variable (más robusto) ===</span>
<span class="n">n_numeric</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_categ</span>     <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_logical</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bool&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_datetime</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;datetime64&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># ✅ Cambio aquí</span>

<span class="n">tipos_tbl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Tipo de variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Numéricas&quot;</span><span class="p">,</span> <span class="s2">&quot;Categóricas&quot;</span><span class="p">,</span> <span class="s2">&quot;Lógicas&quot;</span><span class="p">,</span> <span class="s2">&quot;Fecha / Fecha-hora&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Conteo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">n_numeric</span><span class="p">,</span> <span class="n">n_categ</span><span class="p">,</span> <span class="n">n_logical</span><span class="p">,</span> <span class="n">n_datetime</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">tipos_tbl</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% s</span><span class="s2">obre total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">tipos_tbl</span><span class="p">[</span><span class="s2">&quot;Conteo&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># === 4) Mostrar tablas ===</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensiones del dataset:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dimensiones</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables por tipo:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tipos_tbl</span><span class="p">)</span>

<span class="c1"># === 5) Opcional: visualización estilizada en Jupyter ===</span>
<span class="n">tipos_styled</span> <span class="o">=</span> <span class="p">(</span><span class="n">tipos_tbl</span><span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">format</span><span class="p">({</span><span class="s2">&quot;</span><span class="si">% s</span><span class="s2">obre total&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Conteo&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% s</span><span class="s2">obre total&quot;</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;text-align&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% s</span><span class="s2">obre total&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">tipos_styled</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nota: las variables &#39;Categóricas&#39; incluyen object/category; &quot;</span> \
<span class="s2">&quot;&#39;Fecha&#39; incluye datetime64 (con o sin zona horaria).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones del dataset:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Registros</th>
      <th>Variables</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23544</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables por tipo:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tipo de variable</th>
      <th>Conteo</th>
      <th>% sobre total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Numéricas</td>
      <td>9</td>
      <td>21.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Categóricas</td>
      <td>33</td>
      <td>78.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lógicas</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Fecha / Fecha-hora</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><style type="text/css">
#T_c960f_row0_col1, #T_c960f_row1_col1, #T_c960f_row2_col1, #T_c960f_row3_col1 {
  text-align: right;
}
#T_c960f_row0_col2 {
  text-align: right;
  background-color: #bfd8ed;
  color: #000000;
}
#T_c960f_row1_col2 {
  text-align: right;
  background-color: #08306b;
  color: #f1f1f1;
}
#T_c960f_row2_col2, #T_c960f_row3_col2 {
  text-align: right;
  background-color: #f7fbff;
  color: #000000;
}
</style>
<table id="T_c960f">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_c960f_level0_col0" class="col_heading level0 col0" >Tipo de variable</th>
      <th id="T_c960f_level0_col1" class="col_heading level0 col1" >Conteo</th>
      <th id="T_c960f_level0_col2" class="col_heading level0 col2" >% sobre total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_c960f_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_c960f_row0_col0" class="data row0 col0" >Numéricas</td>
      <td id="T_c960f_row0_col1" class="data row0 col1" >9</td>
      <td id="T_c960f_row0_col2" class="data row0 col2" >21.4</td>
    </tr>
    <tr>
      <th id="T_c960f_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_c960f_row1_col0" class="data row1 col0" >Categóricas</td>
      <td id="T_c960f_row1_col1" class="data row1 col1" >33</td>
      <td id="T_c960f_row1_col2" class="data row1 col2" >78.6</td>
    </tr>
    <tr>
      <th id="T_c960f_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_c960f_row2_col0" class="data row2 col0" >Lógicas</td>
      <td id="T_c960f_row2_col1" class="data row2 col1" >0</td>
      <td id="T_c960f_row2_col2" class="data row2 col2" >0.0</td>
    </tr>
    <tr>
      <th id="T_c960f_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_c960f_row3_col0" class="data row3 col0" >Fecha / Fecha-hora</td>
      <td id="T_c960f_row3_col1" class="data row3 col1" >0</td>
      <td id="T_c960f_row3_col2" class="data row3 col2" >0.0</td>
    </tr>
  </tbody>
</table>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nota: las variables &#39;Categóricas&#39; incluyen object/category; &#39;Fecha&#39; incluye datetime64 (con o sin zona horaria).
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="5">
<li><p><em>Número de valores únicos por columna categórica</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5. Resumir las columnas utilizando describe()para obtener la distribución de las variables,</span>
<span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;object&#39;</span><span class="p">,</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>  <span class="c1"># Número de valores únicos por columna categórica</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Grupo de edad de la victima              17
Grupo Mayor Menor de Edad                 2
Edad judicial                            17
Ciclo Vital                               6
Sexo de la victima                        2
Estado Civil                              7
País de Nacimiento de la Víctima         34
Escolaridad                              12
Pertenencia Grupal                       27
Mes del hecho                            13
Dia del hecho                             8
Rango de Hora del Hecho X 3 Horas        10
Municipio del hecho DANE                978
Departamento del hecho DANE              34
Escenario del Hecho                      51
Zona del Hecho                            4
Actividad Durante el Hecho               17
Circunstancia del Hecho                   1
Manera de Muerte                          1
Mecanismo Causal                         14
Diagnostico Topográfico de la Lesión     12
Presunto Agresor                          1
Condición de la Víctima                   1
Medio de Desplazamiento o Transporte      1
Servicio del Vehículo                     1
Clase o Tipo de Accidente                 1
Objeto de Colisión                        1
Servicio del Objeto de Colisión           1
Razón del Suicidio                       21
Localidad del Hecho                      23
Ancestro Racial                           8
Muni_Nom                                947
Depto_Nom                                33
dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="6">
<li><p><em>Conteo de valores únicos por columna categórica</em></p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6.  Para las variables categóricas, necesitamos utilizar el parámetro include=object</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Grupo de edad de la victima      Grupo Mayor Menor de Edad  \
count                        23544                          23544   
unique                          17                              2   
top                      (20 a 24)  b) Mayores de Edad (&gt;18 años)   
freq                          3413                          21041   

       Edad judicial        Ciclo Vital Sexo de la victima Estado Civil  \
count          23544              23544              23544        23544   
unique            17                  6                  2            7   
top        (20 a 24)  (29 a 59) Adultez             Hombre   Soltero(a)   
freq            3413              10258              18928        11115   

       País de Nacimiento de la Víctima                Escolaridad  \
count                             23544                      23544   
unique                               34                         12   
top                            Colombia  Educación básica primaria   
freq                              22973                       6291   

       Pertenencia Grupal Mes del hecho Dia del hecho  \
count               23544         23544         23544   
unique                 27            13             8   
top               Ninguno          Mayo       Domingo   
freq                17026          2076          4252   

       Rango de Hora del Hecho X 3 Horas Municipio del hecho DANE  \
count                              23544                    23544   
unique                                10                      978   
top                      Sin información             Bogotá, D.C.   
freq                               16130                     3373   

       Departamento del hecho DANE Escenario del Hecho      Zona del Hecho  \
count                        23544               23544               23544   
unique                          34                  51                   4   
top                      Antioquia            Vivienda  Cabecera municipal   
freq                          3913               17380               17466   

       Actividad Durante el Hecho Circunstancia del Hecho  \
count                       23544                   23544   
unique                         17                       1   
top                          Otra   Autolesión voluntaria   
freq                         7552                   23544   

           Manera de Muerte        Mecanismo Causal  \
count                 23544                   23544   
unique                    1                      14   
top     Violenta - Suicidio  Generadores de asfixia   
freq                  23544                   15410   

       Diagnostico Topográfico de la Lesión Presunto Agresor  \
count                                 23544            23544   
unique                                   12                1   
top                        Trauma de cuello        No aplica   
freq                                  14471            23544   

       Condición de la Víctima Medio de Desplazamiento o Transporte  \
count                    23544                                23544   
unique                       1                                    1   
top                  No aplica                            No aplica   
freq                     23544                                23544   

       Servicio del Vehículo Clase o Tipo de Accidente Objeto de Colisión  \
count                  23544                     23544              23544   
unique                     1                         1                  1   
top                No aplica                 No aplica          No aplica   
freq                   23544                     23544              23544   

       Servicio del Objeto de Colisión Razón del Suicidio Localidad del Hecho  \
count                            23544              23544               23544   
unique                               1                 21                  23   
top                          No aplica    Sin información           No aplica   
freq                             23544              12444               20171   

       Ancestro Racial      Muni_Nom  Depto_Nom  
count            23544         23536      23536  
unique               8           947         33  
top            Mestizo  BOGOTÁ, D.C.  ANTIOQUIA  
freq             19524          3373       3913  
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="7">
<li><p><em>Valores nulos por columna</em>:
Número de valores nulos por columna</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 7. Valores nulos por columna</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Valores nulos ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Valores nulos ---
ID                                      0
Año del hecho                           0
Grupo de edad de la victima             0
Grupo Mayor Menor de Edad               0
Edad judicial                           0
Ciclo Vital                             0
Sexo de la victima                      0
Estado Civil                            0
País de Nacimiento de la Víctima        0
Escolaridad                             0
Pertenencia Grupal                      0
Mes del hecho                           0
Dia del hecho                           0
Rango de Hora del Hecho X 3 Horas       0
Código Dane Municipio                   0
Municipio del hecho DANE                0
Departamento del hecho DANE             0
Código Dane Departamento                0
Escenario del Hecho                     0
Zona del Hecho                          0
Actividad Durante el Hecho              0
Circunstancia del Hecho                 0
Manera de Muerte                        0
Mecanismo Causal                        0
Diagnostico Topográfico de la Lesión    0
Presunto Agresor                        0
Condición de la Víctima                 0
Medio de Desplazamiento o Transporte    0
Servicio del Vehículo                   0
Clase o Tipo de Accidente               0
Objeto de Colisión                      0
Servicio del Objeto de Colisión         0
Razón del Suicidio                      0
Localidad del Hecho                     0
Ancestro Racial                         0
Codigo_Dane_Municipio_norm              0
Muni_Cod                                8
Muni_Nom                                8
Depto_Cod                               8
Depto_Nom                               8
latitud                                 8
longitud                                8
dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="8">
<li><p><em>Valores Faltantes</em>:
Número total de valores faltantes en el DataFrame no tiene valores faltantes</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 8 Valores Faltantes</span>
<span class="n">valores_faltantes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="9">
<li><p><em>Mecanismos Causales</em>:
Conteo de frecuencias de mecanismos causales variable para análisis posterior como variable dependinete en el modelo</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 9. Contar frecuencias de mecanismos</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">conteo_mecanismos</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Mecanismo Causal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">conteo_mecanismos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mecanismo Causal
Generadores de asfixia          15410
Tóxico                           3829
Proyectil de arma de fuego       2345
Contundente                      1405
Corto punzante                    255
Cortante                          135
Térmico                            80
Por determinar                     35
Caústico                           19
Corto contundente                  15
Agente o mecanismo explosivo        8
Punzante                            5
Eléctrico                           2
Mecanismo o agente explosivo        1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="10">
<li><p><em>Distribución por sexo</em>:
Distribución de suicidios por sexo</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Detecta la columna de sexo</span>
<span class="n">col_sexo</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;sexo&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="kc">None</span><span class="p">)</span>
<span class="k">if</span> <span class="n">col_sexo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No encuentro una columna que contenga &#39;sexo&#39; en su nombre.&quot;</span><span class="p">)</span>

<span class="c1"># Tabla n y %</span>
<span class="n">serie</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col_sexo</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
         <span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Nan&#39;</span><span class="p">:</span><span class="s1">&#39;Desconocido&#39;</span><span class="p">}))</span>
<span class="n">vc</span> <span class="o">=</span> <span class="n">serie</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">vc</span> <span class="o">/</span> <span class="n">vc</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Frecuencia Absoluta&#39;</span><span class="p">:</span> <span class="n">vc</span><span class="p">,</span> <span class="s1">&#39;Frecuencia Porcentual %&#39;</span><span class="p">:</span> <span class="n">pct</span><span class="p">})</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
<span class="n">display</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>

<span class="c1"># Gráfico</span>
<span class="c1">#fig, ax = plt.subplots()</span>
<span class="c1">#ax.bar(vc.index, vc.values)</span>
<span class="c1">#ax.set_title(&quot;Distribución por sexo&quot;)</span>
<span class="c1">#ax.set_ylabel(&quot;Número de casos&quot;)</span>
<span class="c1">#for i, v in enumerate(vc.values):</span>
    <span class="c1">#ax.text(i, v, f&quot;{v}\n{pct.iloc[i]}%&quot;, ha=&#39;center&#39;, va=&#39;bottom&#39;, fontsize=9)</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frecuencia Absoluta</th>
      <th>Frecuencia Porcentual %</th>
    </tr>
    <tr>
      <th>Sexo de la victima</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hombre</th>
      <td>18928</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>Mujer</th>
      <td>4616</td>
      <td>19.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">StrMethodFormatter</span>

<span class="c1"># Serie limpia</span>
<span class="n">col_sexo</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;sexo&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col_sexo</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
     <span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Nan&#39;</span><span class="p">:</span><span class="s1">&#39;Desconocido&#39;</span><span class="p">}))</span>
<span class="n">vc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">vc</span> <span class="o">/</span> <span class="n">vc</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ordena por frecuencia</span>
<span class="n">vc</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pct</span> <span class="o">=</span> <span class="n">pct</span><span class="p">[</span><span class="n">vc</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="c1"># Gráfico</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">vc</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">vc</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribución por sexo&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Número de casos&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Anota n y %</span>
<span class="k">for</span> <span class="n">rect</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">vc</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">pct</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">(),</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/326f5af2cedb33d648b8bc1a745f51d7fadcb902335afbf645dc12bb7cb2ba5d.png" src="_images/326f5af2cedb33d648b8bc1a745f51d7fadcb902335afbf645dc12bb7cb2ba5d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">PercentFormatter</span>

<span class="c1"># === Construir rowpct (100% por ciclo vital) ===</span>
<span class="n">col_sexo</span>  <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;sexo&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">col_ciclo</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;ciclo&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

<span class="n">sexo</span>  <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_sexo</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Nan&#39;</span><span class="p">:</span><span class="s1">&#39;Desconocido&#39;</span><span class="p">})</span>
<span class="n">ciclo</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_ciclo</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Nan&#39;</span><span class="p">:</span><span class="s1">&#39;Desconocido&#39;</span><span class="p">})</span>

<span class="n">tab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">ciclo</span><span class="p">,</span> <span class="n">sexo</span><span class="p">)</span>                                  <span class="c1"># conteos</span>
<span class="n">rowpct</span> <span class="o">=</span> <span class="p">(</span><span class="n">tab</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">tab</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>           <span class="c1"># % por fila</span>
<span class="n">rowpct</span> <span class="o">=</span> <span class="n">rowpct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># ordenar por n</span>

<span class="c1"># === Gráfica monocrómica ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">cats</span> <span class="o">=</span> <span class="n">rowpct</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues_r</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="mf">0.35</span> <span class="o">+</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cats</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cats</span><span class="p">))]</span>

<span class="n">rowpct</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">PercentFormatter</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ciclo vital&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribución de sexo por ciclo vital (100%)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">]:</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sexo&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.03</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rowpct</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()):</span>
    <span class="n">cum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">cum</span> <span class="o">+</span> <span class="n">val</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f1f1f&#39;</span><span class="p">)</span>
        <span class="n">cum</span> <span class="o">+=</span> <span class="n">val</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9723453c8827e1637a23f9e4dd2c8b6c72c2af2baad0f66e0caf3cc97f6310fe.png" src="_images/9723453c8827e1637a23f9e4dd2c8b6c72c2af2baad0f66e0caf3cc97f6310fe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 1. Cargar datos</span>
<span class="c1"># --------------------------</span>
<span class="c1"># url = url = &#39;https://github.com/jthowinsson/Suicidio_Colombia/raw/main/Presuntos_Suicidios._Colombia%2C_2015_a_2023.xlsx&#39;</span>
<span class="c1"># df = pd.read_excel(url, sheet_name=&quot;Data&quot;)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 2. Recodificar variable dependiente</span>
<span class="c1"># --------------------------</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;mecanismo_binario&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Mecanismo Causal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;generadores de asfixia&quot;</span> <span class="k">else</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 3. Selección de variables predictoras</span>
<span class="c1"># (ajusta según tus columnas disponibles)</span>
<span class="c1"># --------------------------</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Sexo de la victima&quot;</span><span class="p">,</span> <span class="s2">&quot;Edad judicial&quot;</span><span class="p">,</span> <span class="s2">&quot;Estado Civil&quot;</span><span class="p">,</span> <span class="s2">&quot;Escolaridad&quot;</span><span class="p">,</span> <span class="s2">&quot;Zona del Hecho&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mecanismo_binario&quot;</span><span class="p">]</span>

<span class="c1"># Transformar categóricas en dummies</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 4. Dividir train/test</span>
<span class="c1"># --------------------------</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 5. Ajustar modelo logístico</span>
<span class="c1"># --------------------------</span>
<span class="n">logit</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 6. Evaluación</span>
<span class="c1"># --------------------------</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_prob</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reporte de clasificación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># AUC</span>
<span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC:&quot;</span><span class="p">,</span> <span class="n">auc</span><span class="p">)</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 7. Curva ROC</span>
<span class="c1"># --------------------------</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;AUC = </span><span class="si">{</span><span class="n">auc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curva ROC - Regresión Logística&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --------------------------</span>
<span class="c1"># 8. Coeficientes → Odds Ratios</span>
<span class="c1"># --------------------------</span>
<span class="n">odds_ratios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Variable&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="s2">&quot;Coeficiente&quot;</span><span class="p">:</span> <span class="n">logit</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;OR&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logit</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">odds_ratios</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;OR&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matriz de confusión:
[[ 232 2208]
 [ 188 4436]]

Reporte de clasificación:
              precision    recall  f1-score   support

           0       0.55      0.10      0.16      2440
           1       0.67      0.96      0.79      4624

    accuracy                           0.66      7064
   macro avg       0.61      0.53      0.47      7064
weighted avg       0.63      0.66      0.57      7064

AUC: 0.6080241097765047
</pre></div>
</div>
<img alt="_images/c99ad053055610a246bc99fd2843c68ac186b306b4e5dee645bc46c4a5a3223c.png" src="_images/c99ad053055610a246bc99fd2843c68ac186b306b4e5dee645bc46c4a5a3223c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                         Variable  \
17                                                         Estado Civil_No aplica   
1                                                         Edad judicial_(10 a 13)   
23                                          Escolaridad_Educación básica primaria   
31                                                    Escolaridad_Sin escolaridad   
32                                                    Escolaridad_Sin información   
24                      Escolaridad_Educación básica secundaria o secundaria baja   
25                           Escolaridad_Educación inicial y educación preescolar   
26                                  Escolaridad_Educación media o secundaria alta   
2                                                         Edad judicial_(14 a 17)   
19                                                   Estado Civil_Sin información   
21                                                       Estado Civil_Unión libre   
20                                                        Estado Civil_Soltero(a)   
22                                                          Estado Civil_Viudo(a)   
30                                                    Escolaridad_Sin Información   
4                                                         Edad judicial_(20 a 24)   
5                                                         Edad judicial_(25 a 28)   
18                                        Estado Civil_Separado(a), divorciado(a)   
27                        Escolaridad_Educación técnica profesional y tecnológica   
13                                                        Edad judicial_(65 a 69)   
28                            Escolaridad_Especialización, Maestría o equivalente   
6                                                         Edad judicial_(29 a 34)   
3                                                         Edad judicial_(18 a 19)   
12                                                        Edad judicial_(60 a 64)   
11                                                        Edad judicial_(55 a 59)   
15                                                        Edad judicial_(75 a 79)   
14                                                        Edad judicial_(70 a 74)   
34  Zona del Hecho_Centro poblado(corregimiento, inspección de policía y caserío)   
7                                                         Edad judicial_(35 a 39)   
10                                                        Edad judicial_(50 a 54)   
8                                                         Edad judicial_(40 a 44)   
9                                                         Edad judicial_(45 a 49)   
0                                                        Sexo de la victima_Mujer   
16                                                       Edad judicial_(80 y más)   
35                                    Zona del Hecho_Parte rural (vereda y campo)   
29                            Escolaridad_Especialización, maestría o equivalente   
33                                                      Escolaridad_Universitario   
36                                                 Zona del Hecho_Sin información   

    Coeficiente        OR  
17     1.832006  6.246404  
1      1.000773  2.720385  
23     0.571314  1.770593  
31     0.533915  1.705597  
32     0.514179  1.672265  
24     0.473929  1.606293  
25     0.417104  1.517561  
26     0.395206  1.484689  
2      0.326783  1.386500  
19     0.283920  1.328327  
21     0.224748  1.252008  
20     0.164567  1.178883  
22     0.138735  1.148820  
30     0.063022  1.065050  
4      0.023356  1.023631  
5      0.011496  1.011562  
18    -0.046649  0.954422  
27    -0.075886  0.926922  
13    -0.083464  0.919924  
28    -0.088444  0.915355  
6     -0.107290  0.898265  
3     -0.142144  0.867496  
12    -0.178200  0.836775  
11    -0.197152  0.821066  
15    -0.202998  0.816280  
14    -0.224642  0.798802  
34    -0.227821  0.796267  
7     -0.286698  0.750739  
10    -0.317426  0.728020  
8     -0.351744  0.703460  
9     -0.403766  0.667801  
0     -0.418216  0.658220  
16    -0.479769  0.618926  
35    -0.509050  0.601066  
29    -0.585838  0.556639  
33    -0.997392  0.368840  
36    -1.474512  0.228890  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="c1"># url = &quot;https://raw.githubusercontent.com/jthowinsson/Suicidio_Colombia/main/Presuntos_Suicidios_con_Coor.csv&quot;</span>

<span class="c1"># Carga y limpieza básica</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">,</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span>

<span class="c1"># Agregación</span>
<span class="n">ct</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">,</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;casos&#39;</span><span class="p">))</span>

<span class="c1"># Opcional: limitar a los 6 mecanismos más frecuentes para no saturar la gráfica</span>
<span class="n">top_mec</span> <span class="o">=</span> <span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">)[</span><span class="s1">&#39;casos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
             <span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="n">ct</span><span class="p">[</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_mec</span><span class="p">)]</span>

<span class="c1"># Pivot y gráfico</span>
<span class="n">pvt</span> <span class="o">=</span> <span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s1">&#39;casos&#39;</span><span class="p">)</span>
         <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">pvt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Año del hecho&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Número de casos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Serie de tiempo por Mecanismo Causal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mecanismo Causal&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/be561af1b09e9cfb2514f916544a9176377179f01f3c0573b8b6dd891b2a5ad1.png" src="_images/be561af1b09e9cfb2514f916544a9176377179f01f3c0573b8b6dd891b2a5ad1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">unicodedata</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/jthowinsson/Suicidio_Colombia/main/Presuntos_Suicidios_con_Coor.csv&quot;</span>

<span class="c1"># ---- Carga robusta ----</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

<span class="c1"># ---- Normalizar nombres de columnas (minúsculas, sin tildes/espacios) ----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">norm</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s1">&#39;NFKD&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">combining</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="c1"># Intentar mapear posibles nombres</span>
<span class="n">mapa</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sexo_de_la_victima&#39;</span><span class="p">:</span> <span class="s1">&#39;sexo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sexo_de_la_víctima&#39;</span><span class="p">:</span> <span class="s1">&#39;sexo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sexo&#39;</span><span class="p">:</span> <span class="s1">&#39;sexo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;edad_judicial&#39;</span><span class="p">:</span> <span class="s1">&#39;edad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;edad&#39;</span><span class="p">:</span> <span class="s1">&#39;edad&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mapa</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ---- Selección y limpieza ----</span>
<span class="c1"># Primero verificar las columnas disponibles</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas disponibles:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Verificar si tenemos las columnas necesarias o sus posibles variantes</span>
<span class="n">sexo_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;sexo&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
<span class="n">edad_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;edad&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Posibles columnas de sexo:&quot;</span><span class="p">,</span> <span class="n">sexo_cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Posibles columnas de edad:&quot;</span><span class="p">,</span> <span class="n">edad_cols</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">sexo_cols</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">edad_cols</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No se encontraron columnas de sexo o edad&quot;</span><span class="p">)</span>

<span class="c1"># Seleccionar las columnas apropiadas</span>
<span class="n">sexo_col</span> <span class="o">=</span> <span class="n">sexo_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># usar la primera columna que contenga &#39;sexo&#39;</span>
<span class="n">edad_col</span> <span class="o">=</span> <span class="s1">&#39;edad_judicial&#39;</span> <span class="k">if</span> <span class="s1">&#39;edad_judicial&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="n">edad_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Crear DataFrame base</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">sexo_col</span><span class="p">,</span> <span class="n">edad_col</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">base</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">]</span>  <span class="c1"># renombrar columnas</span>

<span class="c1"># Limpiar y convertir edad</span>
<span class="c1"># Si edad es una categoría como &#39;(18 a 19)&#39;, extraer el primer número</span>
<span class="n">base</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Filtrar edades plausibles y datos faltantes</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">])</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">base</span><span class="p">[(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">120</span><span class="p">)]</span>

<span class="c1"># Verificar que tenemos datos</span>
<span class="k">if</span> <span class="n">base</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No quedaron datos después de la limpieza. Verifica los datos originales&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Datos después de la limpieza: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="si">}</span><span class="s2"> filas&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribución de sexo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Estadísticas de edad:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># --- Add this section ---</span>
<span class="k">if</span> <span class="n">base</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame &#39;base&#39; is empty after cleaning.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check for missing or invalid data in &#39;sexo&#39; and &#39;edad&#39; columns.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sexo&#39;</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># Display the first few rows before cleaning</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data available after cleaning. Check the data.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No unique values in &#39;sexo&#39; column after cleaning.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check the values in the &#39;sexo&#39; column.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>  <span class="c1"># Show value counts including NaN</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No unique values in &#39;sexo&#39; column after cleaning.&quot;</span><span class="p">)</span>
<span class="c1"># --- End of added section ---</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No unique values in &#39;sexo&#39; column after cleaning.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check the values in the &#39;sexo&#39; column.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>  <span class="c1"># Show value counts including NaN</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No unique values in &#39;sexo&#39; column after cleaning.&quot;</span><span class="p">)</span>
<span class="c1"># --- End of added section ---</span>

<span class="c1"># ==============================</span>
<span class="c1"># 1) Boxplot edad por sexo</span>
<span class="c1"># ==============================</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;edad&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;sexo&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Edad por sexo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sexo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Edad (años)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ==============================</span>
<span class="c1"># 2) Histogramas comparados de edad por sexo</span>
<span class="c1"># ==============================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">base</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sexo&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Edad (años)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de edad por sexo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sexo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas disponibles: [&#39;id&#39;, &#39;ano_del_hecho&#39;, &#39;grupo_de_edad_de_la_victima&#39;, &#39;grupo_mayor_menor_de_edad&#39;, &#39;edad&#39;, &#39;ciclo_vital&#39;, &#39;sexo&#39;, &#39;estado_civil&#39;, &#39;pais_de_nacimiento_de_la_victima&#39;, &#39;escolaridad&#39;, &#39;pertenencia_grupal&#39;, &#39;mes_del_hecho&#39;, &#39;dia_del_hecho&#39;, &#39;rango_de_hora_del_hecho_x_3_horas&#39;, &#39;codigo_dane_municipio&#39;, &#39;municipio_del_hecho_dane&#39;, &#39;departamento_del_hecho_dane&#39;, &#39;codigo_dane_departamento&#39;, &#39;escenario_del_hecho&#39;, &#39;zona_del_hecho&#39;, &#39;actividad_durante_el_hecho&#39;, &#39;circunstancia_del_hecho&#39;, &#39;manera_de_muerte&#39;, &#39;mecanismo_causal&#39;, &#39;diagnostico_topografico_de_la_lesion&#39;, &#39;presunto_agresor&#39;, &#39;condicion_de_la_victima&#39;, &#39;medio_de_desplazamiento_o_transporte&#39;, &#39;servicio_del_vehiculo&#39;, &#39;clase_o_tipo_de_accidente&#39;, &#39;objeto_de_colision&#39;, &#39;servicio_del_objeto_de_colision&#39;, &#39;razon_del_suicidio&#39;, &#39;localidad_del_hecho&#39;, &#39;ancestro_racial&#39;, &#39;codigo_dane_municipio_norm&#39;, &#39;muni_cod&#39;, &#39;muni_nom&#39;, &#39;depto_cod&#39;, &#39;depto_nom&#39;, &#39;latitud&#39;, &#39;longitud&#39;]

Posibles columnas de sexo: [&#39;sexo&#39;]
Posibles columnas de edad: [&#39;grupo_de_edad_de_la_victima&#39;, &#39;grupo_mayor_menor_de_edad&#39;, &#39;edad&#39;]

Datos después de la limpieza: 23544 filas

Distribución de sexo:
sexo
Hombre    18928
Mujer      4616
Name: count, dtype: int64

Estadísticas de edad:
count    23544.000000
mean        36.149805
std         18.381903
min          5.000000
25%         20.000000
50%         30.000000
75%         50.000000
max         80.000000
Name: edad, dtype: float64
</pre></div>
</div>
<img alt="_images/93ad577daa909e1e774eedcf76683952f0f33d6b5f43236ac64bdaf2b24e27ab.png" src="_images/93ad577daa909e1e774eedcf76683952f0f33d6b5f43236ac64bdaf2b24e27ab.png" />
<img alt="_images/4d9494ef6d5d4d28e551e7fd99c92d290a968106e4eeff2bb54dee6a7e02f0de.png" src="_images/4d9494ef6d5d4d28e551e7fd99c92d290a968106e4eeff2bb54dee6a7e02f0de.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Datos_Met.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Datos y metodología</p>
      </div>
    </a>
    <a class="right-next"
       href="referencias.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Citations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-del-analisis-una-mirada-inicial-a-los-datos">Fundamentos del Análisis: Una Mirada Inicial a los Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desarrollo-del-analisis-exploratorio-de-datos">Desarrollo del Análisis Exploratorio de Datos</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Autor: Msc Jesús D. Zamora Th.
Coautora: Bianca Yibirin U.
Coautora: Laura V. Velásquez O.

</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Msc Jesús D. Zamora Th..
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>